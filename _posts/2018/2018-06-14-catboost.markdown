---
layout: post
title: CatBoost in R&Python
category: CatBoost 
tags: [CatBoost, R, Python]
no-post-nav: true
---



### write test

_Yandex_가 2017년 6월에 논문 [*CatBoost: unbiased boosting with categorical features*](https://arxiv.org/abs/1706.09516)에서 소개한 방법이다. CatBoost는 "Categorical Boost" 약자로, 이름에서부터 범주형 변수를 위한 Boosting 방법이라는 냄새를 풍기고 있다. 저자는 기존에 범주형 변수를 변환했던 방법 중에, "Target mean encoding"로 하면 정보유출(target leakage)이 생긴다고 주장한다. Target mean encoding이란, 범주별로 target 비율을 구해 해당 값으로 대체하는 것이다. 예를 들어, X 변수에 {A, A, A, B, B}가 있고, Target이 {1, 0, 0, 1, 0}이면, A 범주에서 Target 비율은 0.3333, B 범주에서 Target 비율은 0.5 이므로, {0.3333, 0.3333, 0.3333, 0.5, 0.5}로 변환이 된다. 또한, 정보유출로 인해 "conditional shift"가 발생하는데, 다시말해서 train 데이터와 test 데이터가 다른 분포를 가진다는 것이다. 서로 다른 분포를 가진다면, train 데이터에서 학습 된 모형이 test 데이터에 잘 맞기가 힘들 것이다. 개선방안으로 다음 2 step을 제안한다.

- __Ordered TBS(Target-Based Statistics)__
- __Ordered boosting__

먼저, Ordered TBS에 대해서 알아보자. 흥미로운 아이디어는, 변환하기 전에 데이터를 랜덤하게 섞는다는 것이다. 섞은 데이터에서 다음 식을 이용해 변환을 한다. 
